# Instala e carrega o pacote tidyverse, que inclui ggplot2, dplyr, etc.
if (!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“Š GRÃFICO 1: Corte Transversal - InflaÃ§Ã£o em 2024 nos 10 paÃ­ses
# Compara 5 paÃ­ses com maior e 5 com menor inflaÃ§Ã£o no ano de 2024.
# As barras sÃ£o coloridas por grupo e os valores sÃ£o mostrados ao lado de cada barra.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
painel_df <- data.frame(
  PaÃ­s = c("Venezuela", "Argentina", "Turquia", "SudÃ£o", "LÃ­bano",
           "SuÃ­Ã§a", "JapÃ£o", "China", "ArÃ¡bia Saudita", "Estados Unidos"),
  InflaÃ§Ã£o = c(200, 140, 60, 50, 45, 1.2, 1.5, 2, 2.2, 3),
  Grupo = c(rep("Alta inflaÃ§Ã£o", 5), rep("Baixa inflaÃ§Ã£o", 5))
)

# Ordena os dados pela inflaÃ§Ã£o para facilitar a leitura no grÃ¡fico
painel_df <- painel_df %>% arrange(desc(InflaÃ§Ã£o))

# GrÃ¡fico de barras horizontais com valores escritos
ggplot(painel_df, aes(x = InflaÃ§Ã£o, y = reorder(PaÃ­s, InflaÃ§Ã£o), fill = Grupo)) +
  geom_col() +
  geom_text(aes(label = paste0(InflaÃ§Ã£o, "%")), hjust = -0.1, size = 3.5) +
  labs(title = "InflaÃ§Ã£o em 2024: Top 5 Maiores e Menores por PaÃ­s",
       x = "InflaÃ§Ã£o (%)", y = "PaÃ­s") +
  scale_fill_brewer(palette = "Set2") +
  xlim(0, max(painel_df$InflaÃ§Ã£o) + 20) +
  theme_minimal()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“ˆ GRÃFICO 2: Corte Transversal - InflaÃ§Ã£o no Brasil desde 2000
# Mostra a inflaÃ§Ã£o ano a ano no Brasil, com linha da mÃ©dia histÃ³rica.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
anos <- 2000:2025

# Simula dados de inflaÃ§Ã£o realistas para o Brasil
inflacao_brasil <- data.frame(
  ano = anos,
  inflacao = c(runif(10, 4, 10), runif(10, 3, 7), runif(6, 4, 6))
)

# Calcula a mÃ©dia para referenciar no grÃ¡fico
inflacao_media <- mean(inflacao_brasil$inflacao)

# GrÃ¡fico de barras por ano com linha de mÃ©dia
ggplot(inflacao_brasil, aes(x = reorder(as.factor(ano), inflacao), y = inflacao)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_hline(yintercept = inflacao_media, linetype = "dashed", color = "red") +
  labs(title = "InflaÃ§Ã£o no Brasil (2000â€“2025): Corte Transversal",
       x = "Ano", y = "InflaÃ§Ã£o (%)") +
  theme_minimal()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# â³ GRÃFICO 3: SÃ©rie Temporal - InflaÃ§Ã£o vs. Selic no Brasil (2000â€“2025)
# Compara a trajetÃ³ria da inflaÃ§Ã£o com a taxa de juros bÃ¡sica (Selic).
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Simula dados para a taxa Selic no mesmo perÃ­odo
selic_brasil <- data.frame(
  ano = anos,
  selic = c(runif(10, 10, 14), runif(10, 6, 10), runif(6, 2, 13))
)

# Junta os dados de inflaÃ§Ã£o e selic por ano
dados_comparacao <- left_join(inflacao_brasil, selic_brasil, by = "ano")

# Cria a sÃ©rie temporal com linhas separadas para inflaÃ§Ã£o e Selic
ggplot(dados_comparacao, aes(x = ano)) +
  geom_line(aes(y = inflacao, color = "InflaÃ§Ã£o"), size = 1.2) +
  geom_line(aes(y = selic, color = "Taxa Selic"), size = 1.2) +
  labs(title = "SÃ©rie Temporal: InflaÃ§Ã£o vs. Taxa Selic no Brasil (2000â€“2025)",
       x = "Ano", y = "Percentual (%)") +
  scale_color_manual(values = c("InflaÃ§Ã£o" = "orange", "Taxa Selic" = "blue")) +
  theme_minimal()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§© GRÃFICO 4: Dados em Painel - InflaÃ§Ã£o em PaÃ­ses da AmÃ©rica Latina
# Visualiza a inflaÃ§Ã£o de mÃºltiplos paÃ­ses ao longo do tempo.
# Cada paÃ­s tem seu prÃ³prio painel (facet_wrap).
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
set.seed(123)
anos_painel <- 2000:2024
paises <- c("Brasil", "Argentina", "Chile", "Peru", "ColÃ´mbia", "Venezuela")

# Cria grade de paÃ­s Ã— ano
dados_painel <- expand.grid(Ano = anos_painel, Pais = paises)

# Simula inflaÃ§Ã£o aleatÃ³ria entre 2% e 30%
dados_painel$Inflacao <- round(runif(nrow(dados_painel), 2, 30), 1)

# Venezuela recebe inflaÃ§Ã£o mais alta (simulando hiperinflaÃ§Ã£o)
dados_painel$Inflacao[dados_painel$Pais == "Venezuela"] <- 
  round(runif(sum(dados_painel$Pais == "Venezuela"), 50, 300), 1)

# GrÃ¡fico com painÃ©is separados para cada paÃ­s
ggplot(dados_painel, aes(x = Ano, y = Inflacao)) +
  geom_line(color = "darkblue") +
  facet_wrap(~ Pais, scales = "free_y") +
  labs(title = "InflaÃ§Ã£o em PaÃ­ses da AmÃ©rica Latina (2000â€“2024)",
       x = "Ano", y = "InflaÃ§Ã£o (%)") +
  theme_minimal()